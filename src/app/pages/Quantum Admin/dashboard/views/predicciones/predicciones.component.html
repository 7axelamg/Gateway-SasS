<app-layout>
  <div class="min-h-screen bg-gradient-to-br from-cyan-50 to-cyan-100 p-4 md:p-8 md:pl-20 md:pt-12">
    
    <!-- Contenido principal -->
    <div class="md:ml-10">
      
      <!-- Encabezado premium -->
      <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-10 gap-4">
        <div class="mb-4 md:mb-0">
          <h2 class="text-3xl md:text-4xl font-bold text-gray-800">Predicción de Reservas</h2>
          <p class="text-sm md:text-base text-cyan-600 mt-2 font-medium">Análisis predictivo para gestión hotelera inteligente</p>
        </div>
        
      </div>

      <!-- Tarjeta principal con efecto vidrio -->
      <div class="bg-white/80 backdrop-blur-lg rounded-3xl shadow-xl border border-white/30 overflow-hidden mb-10">
        <div class="px-8 py-5 border-b border-white/20 bg-gradient-to-r from-cyan-500 to-cyan-600">
          <h2 class="text-xl font-semibold text-white flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyan-200" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
            <span class="text-white/90">Resultado de la Predicción</span>
          </h2>
        </div>

        <!-- Contenido de la tarjeta -->
        <div class="min-h-screen bg-gray-50 p-4 md:p-8">
          <div class="max-w-6xl mx-auto">
            <!-- Encabezado -->
            <div class="flex justify-between items-center mb-8">
              <div>
                <h1 class="text-2xl font-bold text-gray-800">Predicción de Reservas</h1>
                <p class="text-gray-600">Sistema de análisis predictivo para reservas hoteleras</p>
              </div>
              <button 
        (click)="toggleFormulario()"
        class="px-6 py-3 bg-gradient-to-r from-cyan-600 to-cyan-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-2 w-full md:w-auto transform hover:-translate-y-1 hover:scale-105 group"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 group-hover:rotate-90 transition-transform" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
        </svg>
        <span class="font-semibold">{{ mostrarFormulario ? 'Cancelar' : 'Nueva Predicción' }}</span>
      </button>
            </div>
        
            <!-- Formulario -->
            <div *ngIf="mostrarFormulario" class="bg-white rounded-lg shadow-md p-6 mb-8">
              <h2 class="text-xl font-semibold mb-6 text-gray-800">Datos de la Reserva</h2>
              
              <form (submit)="onSubmit($event)" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <!-- Columna 1 -->
                  <div class="space-y-4">
                    <!-- Edad del cliente -->
                    <div>
                      <label for="client_age" class="block text-sm font-medium text-gray-700 mb-1">Edad del cliente</label>
                      <input 
                        id="client_age" 
                        type="number" 
                        [(ngModel)]="formData.client_age" 
                        name="client_age"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                        min="18"
                      >
                    </div>
        
                    <!-- Cancelaciones anteriores -->
                    <div>
                      <label for="past_cancellations" class="block text-sm font-medium text-gray-700 mb-1">Cancelaciones anteriores</label>
                      <input 
                        id="past_cancellations" 
                        type="number" 
                        [(ngModel)]="formData.past_cancellations" 
                        name="past_cancellations"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                        min="0"
                      >
                    </div>
        
                    <!-- Tasa de cancelación del cliente -->
                    <div>
                      <label for="client_cancellation_rate" class="block text-sm font-medium text-gray-700 mb-1">Tasa de cancelación del cliente (%)</label>
                      <input 
                        id="client_cancellation_rate" 
                        type="number" 
                        step="0.01"
                        [(ngModel)]="formData.client_cancellation_rate" 
                        name="client_cancellation_rate"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                        min="0"
                        max="100"
                      >
                    </div>
        
                    <!-- Estancia promedio -->
                    <div>
                      <label for="client_avg_stay_length" class="block text-sm font-medium text-gray-700 mb-1">Estancia promedio (días)</label>
                      <input 
                        id="client_avg_stay_length" 
                        type="number" 
                        step="0.1"
                        [(ngModel)]="formData.client_avg_stay_length" 
                        name="client_avg_stay_length"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                        min="1"
                      >
                    </div>
                  </div>
        
                  <!-- Columna 2 -->
                  <div class="space-y-4">
                    <!-- Tipo de hotel -->
                    <div>
                      <label for="hotel_type" class="block text-sm font-medium text-gray-700 mb-1">Tipo de hotel</label>
                      <select
                        id="hotel_type" 
                        [(ngModel)]="formData.hotel_type" 
                        name="hotel_type"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                      >
                        <option value="hotel">Hotel</option>
                        <option value="motel">Motel</option>
                        <option value="hostel">Hostel</option>
                        <option value="airbnb">Airbnb</option>
                        <option value="other">Otro</option>
                      </select>
                    </div>
        
                    <!-- Precio de la habitación -->
                    <div>
                      <label for="room_price" class="block text-sm font-medium text-gray-700 mb-1">Precio de la habitación</label>
                      <input 
                        id="room_price" 
                        type="number" 
                        step="0.01"
                        [(ngModel)]="formData.room_price" 
                        name="room_price"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                        min="0"
                      >
                    </div>
        
                    <!-- Capacidad de la habitación -->
                    <div>
                      <label for="room_capacity" class="block text-sm font-medium text-gray-700 mb-1">Capacidad de la habitación</label>
                      <input 
                        id="room_capacity" 
                        type="number" 
                        [(ngModel)]="formData.room_capacity" 
                        name="room_capacity"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                        min="1"
                      >
                    </div>
        
                    <!-- Duración de la estancia -->
                    <div>
                      <label for="stay_duration" class="block text-sm font-medium text-gray-700 mb-1">Duración de la estancia (días)</label>
                      <input 
                        id="stay_duration" 
                        type="number" 
                        [(ngModel)]="formData.stay_duration" 
                        name="stay_duration"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                        min="1"
                      >
                    </div>
                  </div>
                </div>
        
                <!-- Segunda fila de campos -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <!-- Columna 3 -->
                  <div class="space-y-4">
                    <!-- Categoría de tiempo de reserva -->
                    <div>
                      <label for="booking_lead_time_category" class="block text-sm font-medium text-gray-700 mb-1">Antelación de reserva</label>
                      <select
                        id="booking_lead_time_category" 
                        [(ngModel)]="formData.booking_lead_time_category" 
                        name="booking_lead_time_category"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                      >
                        <option value="advanced">Avanzada</option>
                        <option value="short_notice">Aviso corto</option>
                        <option value="last_minute">Último minuto</option>
                      </select>
                    </div>
        
                    <!-- Día de check-in -->
                    <div>
                      <label for="checkin_day_of_week" class="block text-sm font-medium text-gray-700 mb-1">Día de check-in</label>
                      <select
                        id="checkin_day_of_week" 
                        [(ngModel)]="formData.checkin_day_of_week" 
                        name="checkin_day_of_week"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                      >
                        <option value="0">Domingo</option>
                        <option value="1">Lunes</option>
                        <option value="2">Martes</option>
                        <option value="3">Miércoles</option>
                        <option value="4">Jueves</option>
                        <option value="5">Viernes</option>
                        <option value="6">Sábado</option>
                      </select>
                    </div>
        
                    <!-- Check-in en fin de semana -->
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Check-in en fin de semana</label>
                      <div class="flex space-x-4">
                        <label class="inline-flex items-center">
                          <input 
                            type="radio" 
                            [(ngModel)]="formData.is_weekend_checkin" 
                            name="is_weekend_checkin" 
                            [value]="1"
                            class="h-4 w-4 text-blue-600"
                          >
                          <span class="ml-2">Sí</span>
                        </label>
                        <label class="inline-flex items-center">
                          <input 
                            type="radio" 
                            [(ngModel)]="formData.is_weekend_checkin" 
                            name="is_weekend_checkin" 
                            [value]="0"
                            class="h-4 w-4 text-blue-600"
                          >
                          <span class="ml-2">No</span>
                        </label>
                      </div>
                    </div>
                  </div>
        
                  <!-- Columna 4 -->
                  <div class="space-y-4">
                    <!-- Temporada alta -->
                    <div>
                      <label class="block text-sm font-medium text-gray-700 mb-1">Temporada alta</label>
                      <div class="flex space-x-4">
                        <label class="inline-flex items-center">
                          <input 
                            type="radio" 
                            [(ngModel)]="formData.is_high_season" 
                            name="is_high_season" 
                            [value]="1"
                            class="h-4 w-4 text-blue-600"
                          >
                          <span class="ml-2">Sí</span>
                        </label>
                        <label class="inline-flex items-center">
                          <input 
                            type="radio" 
                            [(ngModel)]="formData.is_high_season" 
                            name="is_high_season" 
                            [value]="0"
                            class="h-4 w-4 text-blue-600"
                          >
                          <span class="ml-2">No</span>
                        </label>
                      </div>
                    </div>
        
                    <!-- Reservas confirmadas concurrentes -->
                    <div>
                      <label for="concurrent_confirmed_reservations" class="block text-sm font-medium text-gray-700 mb-1">Reservas concurrentes confirmadas</label>
                      <input 
                        id="concurrent_confirmed_reservations" 
                        type="number" 
                        [(ngModel)]="formData.concurrent_confirmed_reservations" 
                        name="concurrent_confirmed_reservations"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                        min="0"
                      >
                    </div>
        
                    <!-- Tasa de confirmación concurrente -->
                    <div>
                      <label for="concurrent_confirmation_rate" class="block text-sm font-medium text-gray-700 mb-1">Tasa de confirmación concurrente (%)</label>
                      <input 
                        id="concurrent_confirmation_rate" 
                        type="number" 
                        step="0.01"
                        [(ngModel)]="formData.concurrent_confirmation_rate" 
                        name="concurrent_confirmation_rate"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                        required
                        min="0"
                        max="100"
                      >
                    </div>
                  </div>
                </div>
        
                <!-- Tercera fila de campos -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <!-- Estado de pago -->
                  <div>
                    <label for="payment_status_category" class="block text-sm font-medium text-gray-700 mb-1">Estado de pago</label>
                    <select
                      id="payment_status_category" 
                      [(ngModel)]="formData.payment_status_category" 
                      name="payment_status_category"
                      class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      required
                    >
                      <option value="no_payment">Sin pago</option>
                      <option value="paid">Pagado</option>
                    </select>
                  </div>
        
                  <!-- Método de pago -->
                  <div>
                    <label for="payment_method" class="block text-sm font-medium text-gray-700 mb-1">Método de pago</label>
                    <select
                      id="payment_method" 
                      [(ngModel)]="formData.payment_method" 
                      name="payment_method"
                      class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                      required
                    >
                      <option value="other">Otro</option>
                      <option value="visa">Visa</option>
                      <option value="paypal">PayPal</option>
                      <option value="mastercard">Mastercard</option>
                    </select>
                  </div>
                </div>
        
                <!-- Botón de enviar -->
                <div class="pt-4">
                  <button 
                    type="submit"
                    class="px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"
                  >
                    Predecir Estado de Reserva
                  </button>
                </div>
              </form>
            </div>
        
            <!-- Resultados de la predicción -->
            <div *ngIf="prediccion" class="bg-white rounded-lg shadow-md p-6">
              <h2 class="text-xl font-semibold mb-4 text-gray-800">Resultado de la Predicción</h2>
              
              <div class="space-y-4">
                <!-- Resultado principal -->
                <div>
                  <h3 class="font-medium text-gray-700">Predicción:</h3>
                  <p class="text-lg font-bold" [ngClass]="{
                    'text-green-600': prediccion === 'no cancelada',
                    'text-red-600': prediccion === 'cancelada'
                  }">
                    {{ prediccion === 'no cancelada' ? 'Confirmada' : 'Cancelada' }}
                  </p>
                </div>
            
                <!-- Probabilidades -->
                <div *ngIf="probabilidades">
                  <h3 class="font-medium text-gray-700 mb-3">Probabilidades:</h3>
                  
                  <!-- Barra de progreso para "no cancelada" -->
                  <div class="mb-4">
                    <div class="flex justify-between text-sm mb-1">
                      <span>Confirmada</span>
                      <span>{{ probabilidades['no cancelada'].toFixed(2) }}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                      <div class="bg-green-600 h-2.5 rounded-full" 
                           [style.width]="probabilidades['no cancelada'] + '%'"></div>
                    </div>
                  </div>
                  
                  <!-- Barra de progreso para "cancelada" -->
                  <div class="mb-4">
                    <div class="flex justify-between text-sm mb-1">
                      <span>Cancelada</span>
                      <span>{{ probabilidades['cancelada'].toFixed(2) }}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                      <div class="bg-red-600 h-2.5 rounded-full" 
                           [style.width]="probabilidades['cancelada'] + '%'"></div>
                    </div>
                  </div>
                  
                  <!-- Mensaje interpretativo -->
                  <div class="mt-4 p-3 rounded-md" 
                       [ngClass]="{
                         'bg-green-50 text-green-800': prediccion === 'no cancelada',
                         'bg-red-50 text-red-800': prediccion === 'cancelada'
                       }">
                    <p class="text-sm">
                      <span *ngIf="prediccion === 'no cancelada'">
                        ✅ La reserva tiene alta probabilidad de ser confirmada ({{ probabilidades['no cancelada'].toFixed(2) }}%).
                      </span>
                      <span *ngIf="prediccion === 'cancelada'">
                        ⚠️ La reserva tiene riesgo de cancelación ({{ probabilidades['cancelada'].toFixed(2) }}%).
                      </span>
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</app-layout>